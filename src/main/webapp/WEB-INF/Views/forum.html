<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>SoulSpace - Forum</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f9fafb; min-height: 100vh; }
        
        .main-content { margin-left: 16rem; min-height: 100vh; padding: 2rem; transition: margin-left 0.3s ease; }
        @media (max-width: 1024px) { .main-content { margin-left: 0; padding: 1.5rem; } }

        .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .btn-new { background: #3b82f6; color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; text-decoration: none; font-weight: 500; }

        .post-card { background: white; padding: 1.5rem; border-radius: 1rem; border: 1px solid #e5e7eb; margin-bottom: 1rem; cursor: pointer; transition: transform 0.1s; }
        .post-card:hover { transform: translateY(-2px); border-color: #3b82f6; }
        .post-meta { font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem; display: flex; gap: 0.5rem; align-items: center; }
        .author-avatar { width: 1.5rem; height: 1.5rem; background: #e0f2fe; color: #0284c7; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; }
        .post-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: #111827; }
        .post-preview { color: #4b5563; font-size: 0.95rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        .tags { margin-top: 1rem; display: flex; gap: 0.5rem; }
        .tag { background: #f3f4f6; color: #4b5563; padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.75rem; font-weight: 500; }
    </style>
</head>
<body>
    <div th:replace="~{navigation :: sidebar-fragment}"></div>

    <main class="main-content">
        <div class="page-header">
            <h1>Community Forum</h1>
            <a href="#" class="btn-new" onclick="document.getElementById('createModal').style.display='flex'">+ New Post</a>
        </div>

        <div class="post-list">
            <div class="post-card" th:each="post : ${forumPosts}" th:onclick="'window.location.href=\'' + @{/forum/post(id=${post.id})} + '\''">
                <div class="post-meta">
                    <div class="author-avatar" th:text="${post.author.initials}">JD</div>
                    <span th:text="${post.author.firstName} + ' ' + ${post.author.lastName}">Author</span>
                    <span>â€¢</span>
                    <span th:text="${post.timeAgo}">2h ago</span>
                </div>
                <h3 class="post-title" th:text="${post.title}">Title</h3>
                <p class="post-preview" th:text="${post.content}">Content...</p>
                <div class="tags">
                    <span class="tag" th:each="tag : ${#strings.arraySplit(post.tags, ',')}" th:text="${tag}">#tag</span>
                </div>
            </div>
        </div>
    </main>
    
    <div id="createModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:100;">
        <div style="background:white; padding:2rem; border-radius:1rem; width:90%; max-width:500px;">
            <h2 style="margin-bottom:1rem;">Create Post</h2>
            <form th:action="@{/forum}" method="post">
                <input type="hidden" name="action" value="create">
                <input style="width:100%; margin-bottom:1rem; padding:0.75rem; border:1px solid #ccc; border-radius:0.5rem;" type="text" name="title" placeholder="Title" required>
                <input style="width:100%; margin-bottom:1rem; padding:0.75rem; border:1px solid #ccc; border-radius:0.5rem;" type="text" name="category" placeholder="Category">
                <input style="width:100%; margin-bottom:1rem; padding:0.75rem; border:1px solid #ccc; border-radius:0.5rem;" type="text" name="tags" placeholder="Tags (comma separated)">
                <textarea style="width:100%; margin-bottom:1rem; padding:0.75rem; border:1px solid #ccc; border-radius:0.5rem; min-height:100px;" name="content" placeholder="Share your thoughts..." required></textarea>
                <div style="display:flex; justify-content:flex-end; gap:1rem;">
                    <button type="button" onclick="document.getElementById('createModal').style.display='none'" style="padding:0.5rem 1rem; border:1px solid #ccc; background:white; border-radius:0.5rem; cursor:pointer;">Cancel</button>
                    <button type="submit" style="padding:0.5rem 1rem; background:#3b82f6; color:white; border:none; border-radius:0.5rem; cursor:pointer;">Post</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>
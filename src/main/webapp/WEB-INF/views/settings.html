<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>SoulSpace - Settings</title>
    <style>
        /* --- GLOBAL & LAYOUT --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f9fafb; color: #1a1a1a; min-height: 100vh; }
        
        .main-content { margin-left: 16rem; min-height: 100vh; padding: 2rem; transition: margin-left 0.3s ease; }
        @media (max-width: 1024px) { .main-content { margin-left: 0; padding: 1.5rem; } }

        .page-header { margin-bottom: 2rem; }
        .page-header h1 { font-size: 2rem; font-weight: 600; margin-bottom: 0.5rem; }

        /* --- SETTINGS LAYOUT --- */
        .settings-grid { display: grid; grid-template-columns: 240px 1fr; gap: 2rem; align-items: start; }
        @media (max-width: 768px) { .settings-grid { grid-template-columns: 1fr; } }

        /* Settings Sidebar */
        .settings-nav { background: white; border-radius: 0.75rem; border: 1px solid #e5e7eb; overflow: hidden; }
        .nav-btn { display: block; width: 100%; text-align: left; padding: 1rem 1.5rem; border: none; background: white; border-bottom: 1px solid #f3f4f6; color: #4b5563; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .nav-btn:hover { background: #f9fafb; color: #111827; }
        .nav-btn.active { border-left: 3px solid #3b82f6; color: #3b82f6; background: #eff6ff; }

        /* Content Card */
        .settings-card { background: white; border-radius: 1rem; border: 1px solid #e5e7eb; padding: 2rem; }
        .card-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb; }

        /* Forms */
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; color: #374151; }
        .form-input { width: 100%; padding: 0.625rem 0.875rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-family: inherit; font-size: 0.95rem; }
        .form-input:focus { outline: none; border-color: #3b82f6; ring: 2px solid #eff6ff; }
        
        textarea.form-input { min-height: 100px; resize: vertical; }

        .btn-save { background: #3b82f6; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 500; cursor: pointer; font-size: 0.95rem; }
        .btn-save:hover { background: #2563eb; }

        /* Toggles */
        .toggle-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; border-bottom: 1px solid #f3f4f6; }
        .toggle-item:last-child { border-bottom: none; }
        .toggle-text h4 { font-size: 0.95rem; font-weight: 500; margin-bottom: 0.25rem; }
        .toggle-text p { font-size: 0.85rem; color: #6b7280; }
    </style>
</head>
<body>
    <div th:replace="~{navigation :: sidebar-fragment}"></div>

    <main class="main-content">
        <div class="page-header">
            <h1>Account Settings</h1>
            <p>Manage your profile and preferences</p>
        </div>

        <div class="settings-grid">
            <nav class="settings-nav">
                <button class="nav-btn active" onclick="showSection('profile')">Profile</button>
                <button class="nav-btn" onclick="showSection('notifications')">Notifications</button>
            </nav>

            <form th:action="@{/settings}" method="post">
                <div id="profile-section" class="settings-card">
                    <h2 class="card-title">Public Profile</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">First Name</label>
                            <input type="text" class="form-input" name="firstName" th:value="${user.firstName}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Last Name</label>
                            <input type="text" class="form-input" name="lastName" th:value="${user.lastName}">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" name="email" th:value="${user.email}">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Bio</label>
                        <textarea class="form-input" name="bio" th:text="${user.bio}"></textarea>
                    </div>

                    <div style="text-align: right;">
                        <button type="submit" class="btn-save">Save Changes</button>
                    </div>
                </div>

                <div id="notifications-section" class="settings-card" style="display: none;">
                    <h2 class="card-title">Notifications</h2>
                    
                    <div class="toggle-item">
                        <div class="toggle-text">
                            <h4>Email Notifications</h4>
                            <p>Receive weekly wellness summaries</p>
                        </div>
                        <input type="checkbox" name="emailNotif" th:checked="${user.emailNotifications}">
                    </div>

                    <div class="toggle-item">
                        <div class="toggle-text">
                            <h4>Push Notifications</h4>
                            <p>Receive alerts about new messages</p>
                        </div>
                        <input type="checkbox" name="pushNotif" th:checked="${user.pushNotifications}">
                    </div>

                    <div style="text-align: right; margin-top: 1.5rem;">
                        <button type="submit" class="btn-save">Save Preferences</button>
                    </div>
                </div>
            </form>
        </div>
    </main>

    <script>
        function showSection(id) {
            // Hide all sections
            document.getElementById('profile-section').style.display = 'none';
            document.getElementById('notifications-section').style.display = 'none';
            
            // Show selected
            document.getElementById(id + '-section').style.display = 'block';

            // Update Nav Buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>
</body>
</html>